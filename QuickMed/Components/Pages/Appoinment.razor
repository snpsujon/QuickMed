@page "/appoinment"
@inject IJSRuntime JS
<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title text-primary"> <i class="dripicons-information"></i> &nbsp;&nbsp;Patient Information</h4>
            </div><!--end card-header-->
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="mb-3 row">

                            <label for="example-text-input" class="col-sm-1 form-label align-self-center mb-lg-0 text-end">Name</label>
                            <div class="col-sm-3">
                                <input class="form-control form-control-sm" type="text" value="" id="example-text-input">
                            </div>
                            <label for="example-text-input" class="col-sm-1 form-label align-self-center mb-lg-0 text-end">Age</label>
                            <div class="col-sm-1">
                                <input class="form-control form-control-sm" type="number" value="" id="example-text-input">
                            </div>
                            <label for="example-text-input" class="col-sm-1 form-label align-self-center mb-lg-0 text-end">Sex</label>
                            <div class="col-sm-1">
                                <select class="form-select form-select-sm" aria-label="Default select example">
                                    <option selected>Select</option>
                                    <option value="1">M</option>
                                    <option value="2">F</option>
                                    <option value="3">O</option>
                                </select>
                            </div>
                            <label for="example-text-input" class="col-sm-1 form-label align-self-center mb-lg-0 text-end">Address</label>
                            <div class="col-sm-3">
                                <input class="form-control form-select-sm" type="text" value="" id="example-text-input">
                            </div>

                        </div>

                        <div class="mb-3 row">

                            <label for="example-text-input" class="col-sm-1 form-label align-self-center mb-lg-0 text-end">Mobile</label>
                            <div class="col-sm-3">
                                <input class="form-control form-select-sm" type="text" value="" id="example-text-input">
                            </div>
                            <label for="example-text-input" class="col-sm-1 form-label align-self-center mb-lg-0 text-end">Reg No.</label>
                            <div class="col-sm-1">
                                <input class="form-control form-select-sm" type="number" value="" id="example-text-input">
                            </div>
                            <label for="example-text-input" class="col-sm-1 form-label align-self-center mb-lg-0 text-end">Wt</label>
                            <div class="col-sm-1">
                                <input class="form-control form-select-sm" type="number" value="" id="example-text-input">
                            </div>
                            <label for="example-text-input" class="col-sm-1 form-label align-self-center mb-lg-0 text-end">Date</label>
                            <div class="col-sm-3">
                                <input class="form-control form-select-sm" type="date" value="" id="example-text-input">
                            </div>

                        </div>
                        <span class="float-right">
                           <button id="but_add" class="btn btn-success btn-sm float-end" >Save</button>
                        </span>
                    </div>
                </div>
            </div><!--end card-body-->
        </div><!--end card-->
    </div><!--end col-->
</div>
<h3 class="text-primary"> <i class="fas fa-prescription"></i> Prescription List</h3>
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">

                @if (prescriptions == null)
                {
                    <p>Loading prescriptions...</p>
                }
                else if (!prescriptions.Any())
                {
                    <p>No prescriptions found.</p>
                }
                else
                {
                    <table id="datatable-prescriptionList" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                        <thead>
                            <tr>
                                <th class="border-top-0">Name</th>
                                <th class="border-top-0">Date</th>
                                <th class="border-top-0">Reg. No</th>
                                <th class="border-top-0">Weight</th>
                                <th class="border-top-0">Age</th>
                                <th class="border-top-0">Sex</th>
                                <th class="border-top-0">Mobile</th>
                                <th class="border-top-0">Address</th>
                                <th class="border-top-0 text-end">Action</th>
                            </tr>
                        </thead>

                        <tbody>
                            @foreach (var prescription in prescriptions)
                            {
                                <tr>
                                    <td>@prescription.Name</td>
                                    <td>@prescription.Value</td>
                                    <td>@prescription.Name</td>
                                    <td>@prescription.Value</td>
                                    <td>@prescription.Name</td>
                                    <td>@prescription.Value</td>
                                    <td>@prescription.Name</td>
                                    <td>@prescription.Value</td>
                                    <td class="text-end">
                                        <button class="btn btn-soft-primary" title="Edit"><i class="dripicons-pencil"></i></button>
                                        <button class="btn btn-soft-danger" title="Delete"><i class="dripicons-trash"></i></button>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
            </div>
        </div>
    </div> <!-- end col -->
</div> <!-- end row -->
@code {
    private List<Prescription> prescriptions;

    protected override async Task OnInitializedAsync()
    {
        // Load prescription data (this is a placeholder - replace with actual data fetching logic)
        prescriptions = await GetPrescriptionsAsync();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JS.InvokeVoidAsync("makeDataTable", "datatable-prescriptionList");
        }
    }

    private async Task<List<Prescription>> GetPrescriptionsAsync()
    {
        // Placeholder for actual data retrieval logic
        return new List<Prescription>
        {
            new Prescription { Name = "2C", Value = "২ চামচ দিনে ৩ বার" }
        };
    }

    private class Prescription
    {
        public string Name { get; set; }
        public string Value { get; set; }
    }
}